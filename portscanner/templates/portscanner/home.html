{% extends 'scanner/base.html' %}

{% block title %}Nmap Scanner
{% endblock title %}

{% block css %}
<style>
body{
    background-color: #171f30;
    padding: 2%;
}

 .content {
	 width: auto;
	 height: auto;
	 background-color: #171f30;
	 display: flex;
	 justify-content: center;
	 align-items: center;
}
 .content .loading {
	 width: 80px;
	 height: 50px;
	 position: relative;
}
 .content .loading p {
	 top: 0;
	 padding: 0;
	 margin: 0;
	 color: #5389a6;
	 font-family: "Oxygen", sans-serif;
	 animation: text 3.5s ease both infinite;
	 font-size: 12px;
	 letter-spacing: 1px;
}
 @keyframes text {
	 0% {
		 letter-spacing: 1px;
		 transform: translateX(0px);
	}
	 40% {
		 letter-spacing: 2px;
		 transform: translateX(26px);
	}
	 80% {
		 letter-spacing: 1px;
		 transform: translateX(32px);
	}
	 90% {
		 letter-spacing: 2px;
		 transform: translateX(0px);
	}
	 100% {
		 letter-spacing: 1px;
		 transform: translateX(0px);
	}
}
 .content .loading span {
	 background-color: #5389a6;
	 border-radius: 50px;
	 display: block;
	 height: 16px;
	 width: 16px;
	 bottom: 0;
	 position: absolute;
	 transform: translateX(64px);
	 animation: loading 3.5s ease both infinite;
}
 .content .loading span:before {
	 position: absolute;
	 content: "";
	 width: 100%;
	 height: 100%;
	 background-color: #a6dcee;
	 border-radius: inherit;
	 animation: loading2 3.5s ease both infinite;
}
 @keyframes loading {
	 0% {
		 width: 16px;
		 transform: translateX(0px);
	}
	 40% {
		 width: 100%;
		 transform: translateX(0px);
	}
	 80% {
		 width: 16px;
		 transform: translateX(64px);
	}
	 90% {
		 width: 100%;
		 transform: translateX(0px);
	}
	 100% {
		 width: 16px;
		 transform: translateX(0px);
	}
}
 @keyframes loading2 {
	 0% {
		 transform: translateX(0px);
		 width: 16px;
	}
	 40% {
		 transform: translateX(0%);
		 width: 80%;
	}
	 80% {
		 width: 100%;
		 transform: translateX(0px);
	}
	 90% {
		 width: 80%;
		 transform: translateX(15px);
	}
	 100% {
		 transform: translateX(0px);
		 width: 16px;
	}
}

h1{
    color: #fff;
    font-family: "Palatino Linotype", "Book Antiqua", Palatino, serif;
    text-align: center;
}

.center-div{
    margin: auto;
}

.padding-spacer{
    padding: 50px 0px;
}
 
</style>
{% endblock css %}

{% block content %}

<h1>Nmap Port Scanner</h1>

<div class="container">
    <div class="row justify-content-md-center padding-spacer">
        <form action="scan/" class="form-inline" id="scan-form">
            <input type="text" name="domain" class="form-control mb-2 mr-sm-2" id="domain-text" placeholder="domain/IP"/>
            <input type="submit" class="btn btn-primary mb-2" id="scan-button" value="Scan">
        </form>
    </div>

    <div class="row justify-content-md-center">
        <div id="loader" class="content">
            <div class="loading">
                <p>Scanning</p>
                <span></span>
            </div>
        </div>
    </div>
</div>

<script>

var SCAN_RUNNING = false;

$('#loader').hide();

$('#scan-form').submit(function(event){
    event.preventDefault();
    $('#scan-form').prop("disabled", true);

    $('#loader').show();
    var $form = $(this);
    var url = $form.attr('action');
    var $inputs = $form.find("input, button");
    var serializedData = $form.serialize();
    $inputs.prop("disabled", true);

    request = $.ajax({
        url: url,
        type: "POST",
        data: serializedData
    });

    request.done(function(response, textStatus, jqXHR){
        console.log(response);
        $('#loader').hide();
        $inputs.prop("disabled", false);
    });

    request.fail(function(jqXHR, textStatus, errorThrown){
        console.error("Following error occur: "+textStatus, errorThrown);
    });

    //console.log('url:',url);
    //console.log( $('#domain-text').val());
    /*
    $.post(url, 
    {
        domain: $('#domain-text').val()
    },
    function(data, status){
        //success
        console.log(data);
        $('#loader').hide();
    },
    function(){
        //failure
        console.log('failed');
    });
    */

});
</script>

{% endblock content %}